<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Roll Analyzer | GPS Pethgam</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="bg-slate-50 p-4">
    <div class="max-w-4xl mx-auto">
        <h2 class="text-2xl font-black text-slate-800 mb-6 uppercase tracking-tighter">ZEO Return - Roll Analyzer</h2>
        
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
            <div class="bg-white p-6 rounded-3xl shadow-sm border text-center">
                <p class="text-[10px] font-black text-slate-400 uppercase">Total Enrollment</p>
                <h1 id="totalRoll" class="text-3xl font-black text-indigo-600">0</h1>
            </div>
            </div>

        <div class="bg-white rounded-3xl shadow-xl overflow-hidden border border-slate-100">
            <table class="w-full text-left">
                <thead class="bg-slate-800 text-white text-[10px] uppercase">
                    <tr>
                        <th class="p-4">Category</th>
                        <th class="p-4">Boys</th>
                        <th class="p-4">Girls</th>
                        <th class="p-4">Total</th>
                    </tr>
                </thead>
                <tbody id="statsBody" class="font-bold text-slate-700">
                    </tbody>
            </table>
        </div>
    </div>

    <script type="module">
        import { db } from './init-firebase.js';
        import { collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        async function analyzeRoll() {
            const snap = await getDocs(collection(db, "admissions")); // Matches your register collection
            let stats = {
                General: { m: 0, f: 0 },
                RBA: { m: 0, f: 0 },
                ST: { m: 0, f: 0 },
                SC: { m: 0, f: 0 }
            };

            snap.forEach(doc => {
                const s = doc.data();
                const cat = s.category || "General";
                const gen = s.gender === "Male" ? "m" : "f";
                if(stats[cat]) stats[cat][gen]++;
            });

            // Logic to render rows and total count
            document.getElementById('totalRoll').innerText = snap.size;
            // ... (row rendering code)
        }
        analyzeRoll();
    </script>
</body>
</html>

