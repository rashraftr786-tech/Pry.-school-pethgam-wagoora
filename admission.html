<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admission Form - GPS Pethgam Wagoora</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root { --primary: #1b5e20; --border: #000; }
        body { font-family: 'Arial', sans-serif; background: #f0f0f0; padding: 10px; font-size: 11px; }
        .form-page { max-width: 950px; margin: auto; background: white; padding: 25px; border: 2px solid #000; }
        
        .header-container { display: grid; grid-template-columns: 1fr 140px; gap: 10px; border-bottom: 2px solid #000; padding-bottom: 10px; }
        .header-text { text-align: center; }
        .header-text h1 { margin: 0; font-size: 18px; text-transform: uppercase; }
        
        .photo-box { width: 120px; height: 140px; border: 1px solid #000; display: flex; align-items: center; justify-content: center; text-align: center; background: #f9f9f9; cursor: pointer; }
        .photo-box img { width: 100%; height: 100%; object-fit: cover; display: none; }

        .field-row { display: flex; align-items: center; margin-bottom: 8px; gap: 5px; flex-wrap: wrap; }
        .label { font-weight: bold; white-space: nowrap; min-width: 120px; }
        .dotted-input { border: none; border-bottom: 1px dotted #000; flex: 1; padding: 1px; outline: none; font-size: 11px; }
        
        .box-container { display: flex; flex-wrap: wrap; }
        .char-box { width: 16px; height: 16px; border: 1px solid #000; margin-right: -1px; margin-bottom: 1px; }
        .char-box input { width: 100%; height: 100%; border: none; text-align: center; text-transform: uppercase; font-size: 10px; }

        .section-head { font-weight: bold; text-decoration: underline; margin: 12px 0 5px 0; background: #eee; padding: 3px; text-transform: uppercase; }
        .doc-upload { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; background: #fafafa; padding: 10px; border: 1px solid #ccc; }
        
        .declaration-text { font-size: 10px; line-height: 1.3; margin-top: 10px; border: 1px solid #000; padding: 8px; }
        .btn-footer { margin-top: 20px; display: flex; gap: 10px; justify-content: center; }
        .btn { padding: 10px 20px; border: none; cursor: pointer; color: white; font-weight: bold; border-radius: 4px; }
        .btn-save { background: var(--primary); }
        .btn-pdf { background: #000; }
        
        @media print { .btn-footer, .doc-upload { display: none; } }
    </style>
</head>
<body>

<div class="form-page">
    <div class="header-container">
        <div class="header-text">
            <h1>Government Primary School Pethgam Wagoora</h1>
            <p>Wagoora Babareshi Road Near Zonal Education Office Wagoora</p>
            <p>Email: pspethgam@gmail.com | UDISE Code: 01022202207</p>
            <div style="font-size: 16px; font-weight: bold; margin-top: 5px; text-decoration: underline;">ADMISSION FORM</div>
        </div>
        <div class="photo-box" onclick="document.getElementById('photoInput').click()">
            <span id="photoLabel">Affix Photo</span>
            <img id="preview">
            <input type="file" id="photoInput" hidden accept="image/*" onchange="previewImage(this)">
        </div>
    </div>

    <form id="admissionForm">
        <div class="section-head">Student Identity</div>
        <div class="field-row">
            <span class="label">Student's Name:</span>
            <div class="box-container" id="nameBoxes"></div>
        </div>
        <div class="field-row">
            <span class="label">Name (As per Aadhaar):</span>
            <div class="box-container" id="aadhaarNameBoxes"></div>
        </div>
        <div class="field-row">
            <span class="label">Gender:</span>
            <input type="radio" name="gender" value="Male"> Male 
            <input type="radio" name="gender" value="Female"> Female 
            <input type="radio" name="gender" value="Other"> Other
            <span class="label" style="min-width: 50px; margin-left:20px;">DOB:</span>
            <input type="date" name="dob" style="border:1px solid #000;">
        </div>

        <div class="field-row">
            <span class="label">Father's Name:</span>
            <input type="text" class="dotted-input" name="fatherName">
            <span class="label" style="min-width: 80px;">Mother's Name:</span>
            <input type="text" class="dotted-input" name="motherName">
        </div>

        <div class="section-head">Address & Contact</div>
        <div class="field-row">
            <span class="label">Mohallah/Village:</span>
            <input type="text" class="dotted-input" name="mohallah">
            <span class="label" style="min-width: 50px;">Tehsil:</span>
            <input type="text" class="dotted-input" name="tehsil">
        </div>
        <div class="field-row">
            <span class="label">District:</span>
            <input type="text" class="dotted-input" name="district" value="Baramulla">
            <span class="label" style="min-width: 50px;">PIN:</span>
            <input type="text" class="dotted-input" name="pincode" value="193109">
        </div>
        <div class="field-row">
            <span class="label">Father's Contact:</span>
            <input type="text" class="dotted-input" name="fContact">
            <span class="label" style="min-width: 100px;">Mother's Contact:</span>
            <input type="text" class="dotted-input" name="mContact">
        </div>

        <div class="section-head">Identifiers & Class</div>
        <div class="field-row">
            <span class="label">Aadhaar Number:</span>
            <div class="box-container" id="aadhaarNumBoxes"></div>
        </div>
        <div class="field-row">
            <span class="label">Category:</span>
            <input type="radio" name="cat" value="SC"> SC 
            <input type="radio" name="cat" value="ST"> ST 
            <input type="radio" name="cat" value="OBC"> OBC 
            <input type="radio" name="cat" value="General"> General
            <span class="label" style="min-width: 60px; margin-left:15px;">Blood Gr:</span>
            <input type="text" class="dotted-input" name="bloodGroup" style="max-width: 40px;">
        </div>
        <div class="field-row">
            <span class="label">Class Joining:</span>
            <select name="sclass" required>
                <option value="">--Select--</option>
                <option>Pre-Primary 3</option><option>Pre-Primary 2</option><option>Balvatika</option>
                <option>1st</option><option>2nd</option><option>3rd</option><option>4th</option><option>5th</option>
            </select>
            <span class="label" style="min-width: 60px; margin-left:15px;">PEN:</span>
            <input type="text" class="dotted-input" name="penNumber">
        </div>

        <div class="section-head">Bank Account Details</div>
        <div class="field-row">
            <span class="label">Bank Account No:</span>
            <input type="text" class="dotted-input" name="bankAcc">
            <span class="label" style="min-width: 60px;">Bank Name:</span>
            <input type="text" class="dotted-input" name="bankName">
        </div>
        <div class="field-row">
            <span class="label">Bank Branch:</span>
            <input type="text" class="dotted-input" name="branch">
            <span class="label" style="min-width: 60px;">IFSC Code:</span>
            <input type="text" class="dotted-input" name="ifsc">
        </div>

        <div class="section-head">ðŸ“Ž Document Upload</div>
        <div class="doc-upload">
            <div>Birth Cert: <input type="file" name="docBirth" required></div>
            <div>Blood Gr: <input type="file" name="docBlood" required></div>
            <div>Aadhaar: <input type="file" name="docAadhaar" required></div>
        </div>

        <div class="declaration-text">
            <strong>Parents Declaration:</strong> I do hereby declare that the above information provided by me is true to the best of my knowledge and belief. I further declare that I will abide by the rules and regulations laid down by the school and the department from time to time... I hereby declare that as the Parent of above mentioned student I am giving my consent to provide the AADHAAR for the demographic authentication of the student.
            <br><br>
            <input type="checkbox" id="consent" required> <strong>I Agree to the Declaration and APAAR Consent.</strong>
        </div>

        <div class="btn-footer">
            <button type="button" class="btn btn-pdf" onclick="window.print()">Print / Download PDF</button>
            <button type="button" class="btn btn-save" onclick="saveAndProceed()">Submit & Proceed to APAAR Form</button>
        </div>
    </form>
</div>

<script>
    function createBoxes(id, count) {
        const container = document.getElementById(id);
        for(let i=0; i<count; i++) {
            const div = document.createElement('div');
            div.className = 'char-box';
            div.innerHTML = '<input type="text" maxlength="1">';
            container.appendChild(div);
        }
    }

    window.onload = () => {
        createBoxes('nameBoxes', 32);
        createBoxes('aadhaarNameBoxes', 32);
        createBoxes('aadhaarNumBoxes', 12);
    };

    function previewImage(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = e => {
                const preview = document.getElementById('preview');
                preview.src = e.target.result;
                preview.style.display = 'block';
                document.getElementById('photoLabel').style.display = 'none';
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    function saveAndProceed() {
        const form = document.getElementById('admissionForm');
        if(!form.checkValidity()) {
            alert("Please fill all required fields and check the declaration.");
            return;
        }

        const formData = new FormData(form);
        const data = Object.fromEntries(formData.entries());
        
        // --- DATA SAVING LOGIC ---
        // We use 'admissionData' key to sync with adm-register.html
        let register = JSON.parse(localStorage.getItem('admissionData')) || [];
        register.push({
            ...data,
            sname: data.fatherName, // Placeholder for sorting if name boxes aren't read as one string
            timestamp: new Date().toLocaleString(),
            status: "Submitted"
        });
        localStorage.setItem('admissionData', JSON.stringify(register));

        alert("Data Saved to Register! Now proceeding to APAAR Consent Form.");
        window.location.href = 'apaar-consent.html'; // Ensure this file exists
    }
</script>
</body>
</html>

