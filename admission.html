<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admission Form - GPS Pethgam Wagoora</title>
  <style>
    @page { size: A4; margin: 5mm; }
    body { font-family: 'Segoe UI', Arial, sans-serif; background: #f0f0f0; margin: 0; padding: 0; color: #222; font-size: 11px; }
    
    .no-print { background: #1a5d1a; padding: 10px; display: flex; gap: 15px; justify-content: center; border-bottom: 3px solid #ffcc00; }
    .no-print a { color: white; text-decoration: none; font-weight: bold; padding: 6px 12px; border-radius: 4px; background: rgba(255,255,255,0.1); font-size: 12px; }

    .page-border {
      background: white;
      width: 210mm;
      height: 285mm; /* Fixed height to force single page */
      margin: 10px auto;
      padding: 8mm 12mm;
      box-sizing: border-box;
      border: 2px solid darkgreen;
      overflow: hidden;
    }

    .header-container { display: flex; align-items: center; border-bottom: 2px solid darkgreen; padding-bottom: 5px; margin-bottom: 8px; }
    .school-logo { width: 65px; height: 65px; margin-right: 15px; }
    .header-text h1 { margin: 0; font-size: 18px; color: darkgreen; text-transform: uppercase; }
    .header-text p { margin: 1px 0; font-size: 10px; color: #333; }

    .form-title { text-align: center; font-weight: bold; font-size: 14px; margin: 8px 0; text-decoration: underline; }

    h3 { font-size: 11px; margin: 8px 0 5px 0; background: #f0f9f0; padding: 3px 8px; border-left: 3px solid darkgreen; text-transform: uppercase; }

    .row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 5px; }
    .field-group { display: flex; flex-direction: column; }
    
    label { font-weight: bold; font-size: 9px; margin-bottom: 1px; color: #444; }
    input, select, textarea { padding: 4px; font-size: 11px; border: 1px solid #999; border-radius: 2px; }

    .photo-box {
      width: 90px;
      height: 105px;
      border: 1px solid #000;
      text-align: center;
      background: #fafafa;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    .declaration-box { font-size: 10px; line-height: 1.3; border: 1px solid #ddd; padding: 6px; background: #fcfcfc; margin-top: 5px; }
    .sig-section { display: grid; grid-template-columns: 1fr 1fr; margin-top: 25px; }
    .sig-placeholder { border-top: 1px solid #000; text-align: center; font-size: 10px; font-weight: bold; width: 160px; }

    #officeSection { border: 1px dashed darkred; padding: 8px; margin-top: 10px; background: #fffafa; }

    @media print {
      body { background: none; }
      .no-print { display: none !important; }
      .page-border { margin: 0; border: 1px solid darkgreen; box-shadow: none; width: 100%; height: 100%; }
    }
  </style>
</head>
<body>

<div class="no-print">
    <a href="admission.html">üìù New Admission</a>
    <a href="adm-register.html">üìã View Register</a>
</div>

<div class="page-border">
  <div class="header-container">
    <img src="logo.png" alt="Logo" class="school-logo">
    <div class="header-text">
      <h1>Government Primary School Pethgam Wagoora</h1>
      <p>UDISE: 01022202207 | E-mail: pspethgam@gmail.com | Baramulla, J&K</p>
    </div>
  </div>

  <div class="form-title">STUDENT ADMISSION FORM - 2026</div>

  <form id="admissionForm">
    <div class="row" style="grid-template-columns: 1fr 1fr 100px;">
      <div class="field-group" style="grid-column: span 2;">
        <label>Full Name of Student</label>
        <input type="text" id="studentName" required>
        <label style="margin-top:5px">Name (As per Aadhaar)</label>
        <input type="text" id="aadhaarName">
        <div class="row" style="margin-top:5px">
            <div class="field-group"><label>Date of Birth</label><input type="date" id="dob" onchange="convertDOBToWords()" required></div>
            <div class="field-group" style="grid-column: span 2;"><label>DOB In Words</label><input type="text" id="dobWords" readonly></div>
        </div>
      </div>
      <div class="photo-box">
        <img id="photoPreview" style="max-width:100%; max-height:100%; display:none;">
        <p id="photoTxt" style="font-size:8px">Affix Photo</p>
        <input type="file" id="photoInput" onchange="processPhoto(event)" class="no-print" style="width:80px; font-size:7px;">
      </div>
    </div>

    <div class="row">
      <div class="field-group"><label>Gender</label><select id="gender"><option>Male</option><option>Female</option></select></div>
      <div class="field-group"><label>Blood Group</label><input type="text" id="bloodGroup"></div>
      <div class="field-group"><label>Seeking Class</label><input type="text" id="studentClass" required></div>
    </div>

    <div class="row">
        <div class="field-group"><label>Aadhaar No</label><input type="text" id="aadhaarNo" maxlength="12"></div>
        <div class="field-group"><label>APAAR ID</label><input type="text" id="apaarId"></div>
        <div class="field-group"><label>PEN Number</label><input type="text" id="penId"></div>
    </div>

    <h3>Parental Information</h3>
    <div class="row">
        <div class="field-group"><label>Father's Name</label><input type="text" id="fatherName" required></div>
        <div class="field-group"><label>Mother's Name</label><input type="text" id="motherName" required></div>
        <div class="field-group"><label>Contact No</label><input type="tel" id="fatherContact" maxlength="10"></div>
    </div>

    <div class="row">
        <div class="field-group"><label>Bank Account No</label><input type="text" id="bankAcc"></div>
        <div class="field-group"><label>IFSC Code</label><input type="text" id="ifsc"></div>
        <div class="field-group"><label>Village</label><input type="text" id="village"></div>
    </div>

    <div class="declaration-box">
        <strong>Declaration:</strong> I hereby declare that the information provided is correct. I give consent for Aadhaar authentication for educational purposes.
    </div>

    <div class="sig-section">
        <div></div>
        <div class="sig-placeholder" style="margin-left: auto;">Signature of Parent</div>
    </div>

    <div id="officeSection">
      <h3 style="color:darkred">OFFICE USE</h3>
      <div class="row">
        <div class="field-group"><label>Adm No</label><input type="text" id="admNo"></div>
        <div class="field-group"><label>Date of Adm</label><input type="date" id="admDate"></div>
        <div class="field-group"><label>Category</label><input type="text" id="category"></div>
      </div>
      <div class="sig-section" style="margin-top: 25px;">
        <div class="sig-placeholder">Incharge</div>
        <div class="sig-placeholder" style="margin-left: auto;">HOI Signature</div>
      </div>
    </div>

    <div class="no-print" style="text-align:center; margin-top:10px;">
      <button type="button" onclick="saveData()" style="background:darkgreen; color:white; padding:8px 20px;">Save Record</button>
      <button type="button" onclick="window.print()" style="background:#333; color:white; padding:8px 20px;">Print Form</button>
    </div>
  </form>
</div>

<script>
// --- 1. PROPER DATE TO WORDS CONVERSION ---
function convertDOBToWords() {
    const dob = document.getElementById("dob").value;
    if (!dob) return;
    const date = new Date(dob);
    const day = date.getDate();
    const year = date.getFullYear();
    const months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
    
    const ones = ["", "One", "Two", "Three", "Four", "Five", "Six", "Seven", "Eight", "Nine", "Ten", "Eleven", "Twelve", "Thirteen", "Fourteen", "Fifteen", "Sixteen", "Seventeen", "Eighteen", "Nineteen"];
    const tens = ["", "", "Twenty", "Thirty"];
    const ordinals = ["", "First", "Second", "Third", "Fourth", "Fifth", "Sixth", "Seventh", "Eighth", "Ninth", "Tenth", "Eleventh", "Twelfth", "Thirteenth", "Fourteenth", "Fifteenth", "Sixteenth", "Seventeenth", "Eighteenth", "Nineteenth", "Twentieth", "Twenty First", "Twenty Second", "Twenty Third", "Twenty Fourth", "Twenty Fifth", "Twenty Sixth", "Twenty Seventh", "Twenty Eighth", "Twenty Ninth", "Thirtieth", "Thirty First"];

    let yearWords = "Two Thousand " + (year - 2000 > 19 ? tens[Math.floor((year-2000)/10)] + " " + ones[(year-2000)%10] : ones[year-2000]);
    
    document.getElementById("dobWords").value = `${ordinals[day]} ${months[date.getMonth()]} ${yearWords}`;
}

// --- 2. AUTOMATIC PHOTO COMPRESSION ---
function processPhoto(event) {
    const file = event.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function(e) {
        const img = new Image();
        img.onload = function() {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            // Set tiny dimensions for storage
            canvas.width = 150; 
            canvas.height = 180;
            ctx.drawImage(img, 0, 0, 150, 180);
            const compressedBase64 = canvas.toDataURL('image/jpeg', 0.7); // 70% quality
            document.getElementById("photoPreview").src = compressedBase64;
            document.getElementById("photoPreview").style.display = "block";
            document.getElementById("photoTxt").style.display = "none";
        };
        img.src = e.target.result;
    };
    reader.readAsDataURL(file);
}

// --- 3. SAVE DATA ---
function saveData() {
    const admNo = document.getElementById("admNo").value;
    if(!admNo) { alert("Please enter Admission No"); return; }

    const studentData = {
        admNo: admNo,
        studentName: document.getElementById("studentName").value,
        dob: document.getElementById("dob").value,
        studentClass: document.getElementById("studentClass").value,
        studentPhoto: document.getElementById("photoPreview").src,
        fatherName: document.getElementById("fatherName").value,
        motherName: document.getElementById("motherName").value,
        status: "Approved"
    };

    let records = JSON.parse(localStorage.getItem("admissions")) || [];
    const index = records.findIndex(r => r.admNo === admNo);
    if(index > -1) records[index] = studentData; else records.push(studentData);

    try {
        localStorage.setItem("admissions", JSON.stringify(records));
        alert("Record Saved Successfully!");
    } catch(e) {
        alert("Error: Storage full. Use a smaller photo.");
    }
}
</script>
</body>
</html>
                    
