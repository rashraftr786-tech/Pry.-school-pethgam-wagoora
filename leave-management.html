<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Leave & Absence Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-50 p-6">
    <div class="max-w-xl mx-auto bg-white p-8 rounded-3xl shadow-lg border border-slate-200">
        <h2 class="text-xl font-black mb-4">Record Absence / Leave</h2>
        <div class="space-y-4">
            <select id="personSelect" class="w-full p-4 rounded-2xl border font-bold">
                <option>-- Select Student or Staff --</option>
            </select>
            <input type="date" id="leaveDate" class="w-full p-4 rounded-2xl border font-bold">
            <textarea id="reason" placeholder="Reason (Sick, Casual, Long-term Absence)" class="w-full p-4 rounded-2xl border font-bold"></textarea>
            
            <button onclick="logLeave()" class="w-full bg-red-600 text-white font-black py-4 rounded-2xl">
                SAVE & SEND ALERT
            </button>
        </div>
    </div>

    <script type="module">
        import { db } from './init-firebase.js';
        import { collection, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        window.logLeave = async () => {
            const data = {
                name: document.getElementById('personSelect').value,
                date: document.getElementById('leaveDate').value,
                reason: document.getElementById('reason').value,
                timestamp: new Date()
            };

            try {
                await addDoc(collection(db, "leaves"), data);
                alert("Leave Recorded. Now redirecting to Communication Center for Parent Alert.");
                window.location.href = "broadcast-whatsapp.html"; // Links to your Comm Center
            } catch (e) { console.error(e); }
        };
    </script>
</body>
</html>

