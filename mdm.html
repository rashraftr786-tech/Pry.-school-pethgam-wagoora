<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Daily MDM Entry - GPS Pethgam Wagoora</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f4f4f4; }
        .form-card { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); max-width: 400px; margin: auto; }
        h2 { color: darkgreen; text-align: center; margin-top: 0; }
        .input-group { margin-bottom: 15px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 14px; }
        input { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background: darkgreen; color: white; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; }
        .nav-links { text-align: center; margin-top: 20px; }
        .nav-links a { color: #555; text-decoration: none; font-size: 13px; }
    </style>
</head>
<body>

<div class="form-card">
    <h2>Daily MDM Log</h2>
    <form id="mdmForm">
        <div class="input-group">
            <label>Date</label>
            <input type="date" id="logDate" required>
        </div>
        <div class="input-group">
            <label>Pre-Primary (Bal Vatika) Students</label>
            <input type="number" id="prePriCount" placeholder="Number of students fed" required>
        </div>
        <div class="input-group">
            <label>Primary Students (1st-5th)</label>
            <input type="number" id="priCount" placeholder="Number of students fed" required>
        </div>
        <hr>
        <div class="input-group">
            <label>Grains Lifted (kg) - <small>If any today</small></label>
            <input type="number" id="grainsLifted" step="0.001" value="0">
        </div>
        <div class="input-group">
            <label>Funds Received (₹) - <small>If any today</small></label>
            <input type="number" id="fundsReceived" step="0.01" value="0">
        </div>
        <button type="button" onclick="saveDailyMDM()">Save Daily Record</button>
    </form>
    <div class="nav-links">
        <a href="mdm-statement.html">View Monthly Statement →</a>
    </div>
</div>

<script>
    // Set default date to today
    document.getElementById('logDate').valueAsDate = new Date();

    function saveDailyMDM() {
        const date = document.getElementById('logDate').value;
        const prePri = parseInt(document.getElementById('prePriCount').value) || 0;
        const pri = parseInt(document.getElementById('priCount').value) || 0;
        const lifted = parseFloat(document.getElementById('grainsLifted').value) || 0;
        const funds = parseFloat(document.getElementById('fundsReceived').value) || 0;

        const dailyRecord = {
            date,
            prePriCount: prePri,
            priCount: pri,
            grainsLifted: lifted,
            fundsReceived: funds,
            grainsUtilized: (prePri + pri) * 0.100 // 100g per student
        };

        let mdmLogs = JSON.parse(localStorage.getItem("mdmDailyLogs")) || [];
        
        // Update if date exists, else push
        const index = mdmLogs.findIndex(l => l.date === date);
        if (index > -1) mdmLogs[index] = dailyRecord;
        else mdmLogs.push(dailyRecord);

        localStorage.setItem("mdmDailyLogs", JSON.stringify(mdmLogs));
        alert("Data saved for " + date);
        document.getElementById('mdmForm').reset();
        document.getElementById('logDate').valueAsDate = new Date();
    }
</script>
</body>
</html>
                
