<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Complete Admission Dossier - GPS Pethgam</title>
    <style>
        body { margin: 0; padding: 0; background: #eee; font-family: 'Segoe UI', sans-serif; }
        .page {
            width: 210mm; height: 296mm; padding: 15mm; margin: 10mm auto;
            background: white; border: 1px solid #ddd; position: relative;
            page-break-after: always; box-sizing: border-box; overflow: hidden;
        }
        .watermark {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 450px; opacity: 0.05; z-index: 0; pointer-events: none;
        }
        .content { position: relative; z-index: 1; }
        .header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 10px; margin-bottom: 20px; }
        .header h1 { font-size: 22px; margin: 5px 0; }
        
        /* Grid Table for Admission Form */
        table { width: 100%; border-collapse: collapse; margin-top: 10px; table-layout: fixed; }
        td { border: 1px solid #000; padding: 8px; font-size: 13px; word-wrap: break-word; }
        .label { background: #f2f2f2; font-weight: bold; width: 30%; }

        /* Photo Styles */
        .photo-box { width: 130px; height: 160px; border: 1px solid #000; float: right; }
        .photo-box img { width: 100%; height: 100%; object-fit: cover; }

        /* Document Previews */
        .doc-preview { max-width: 100%; max-height: 800px; display: block; margin: 20px auto; border: 1px solid #ccc; }
        
        .footer-sigs { margin-top: 50px; display: flex; justify-content: space-between; font-weight: bold; font-size: 14px; }
        .sig-line { border-top: 1px solid #000; width: 200px; text-align: center; padding-top: 5px; }

        @media print {
            body { background: none; }
            .page { margin: 0; border: none; box-shadow: none; }
            .no-print { display: none; }
        }
        .no-print { position: fixed; top: 20px; right: 20px; background: #2e7d32; color: white; padding: 15px 25px; border-radius: 30px; cursor: pointer; border: none; font-weight: bold; z-index: 999; }
    </style>
</head>
<body>

<button class="no-print" onclick="window.print()">ðŸ“¥ Print/Save 7-Page PDF</button>

<div class="page">
    <img src="logo.png" class="watermark">
    <div class="content">
        <div class="header">
            <h1>GOVERNMENT PRIMARY SCHOOL PETHGAM WAGOORA</h1>
            <p>UDISE Code: 01022202207 | Session 2026-27</p>
        </div>
        <div class="photo-box"><img id="pdfPhoto"></div>
        <h2 style="text-align:center; text-decoration: underline;">ADMISSION FORM</h2>
        
        <table>
            <tr><td class="label">Student Name</td><td id="res_sname" colspan="3"></td></tr>
            <tr><td class="label">Name (As per Aadhaar)</td><td id="res_aadhaarName" colspan="3"></td></tr>
            <tr><td class="label">Father's Name</td><td id="res_fname"></td><td class="label">Mother's Name</td><td id="res_mname"></td></tr>
            <tr><td class="label">Date of Birth</td><td id="res_dob"></td><td class="label">Gender</td><td id="res_gender"></td></tr>
            <tr><td class="label">Mohallah/Village</td><td id="res_village"></td><td class="label">Tehsil</td><td id="res_tehsil"></td></tr>
            <tr><td class="label">Father's Contact</td><td id="res_fContact"></td><td class="label">Mother's Contact</td><td id="res_mContact"></td></tr>
            <tr><td class="label">Aadhaar Number</td><td id="res_aadhaar"></td><td class="label">Blood Group</td><td id="res_bloodGroup"></td></tr>
            <tr><td class="label">APAAR ID</td><td id="res_apaarId"></td><td class="label">PEN No.</td><td id="res_penNo"></td></tr>
            <tr><td class="label">Bank Account</td><td id="res_bankAcc"></td><td class="label">IFSC Code</td><td id="res_ifsc"></td></tr>
            <tr><td class="label">Class Joining</td><td id="res_sclass"></td><td class="label">Category</td><td id="res_cat"></td></tr>
        </table>

        <div style="margin-top:20px; font-size:12px; text-align: justify;">
            <strong>Parents Declaration:</strong> I hereby declare that the information provided is true. I abide by school rules and consent to Aadhaar authentication for APAAR ID generation.
        </div>
        <div class="footer-sigs">
            <div class="sig-line">Signature of Parent</div>
            <div class="sig-line">Headmaster Seal</div>
        </div>
    </div>
</div>

<div class="page">
    <img src="logo.png" class="watermark">
    <div class="content">
        <div class="header">
            <h1>CONSENT FOR APAAR ID GENERATION</h1>
        </div>
        <p style="text-align: justify; font-size: 14px; line-height: 1.8;">
            I, <strong id="con_parent"></strong>, relationship <strong id="con_rel"></strong> of student <strong id="con_student"></strong>, 
            holding Identity Proof <strong id="con_idType"></strong> No: <strong id="con_idNum"></strong>, voluntarily give my consent to share Aadhaar Number 
            and demographic information for APAAR ID and DigiLocker creation.
        </p>
        <p style="font-size: 13px; color: #444;">(Full legal text as per Ministry of Education guidelines...)</p>
        <div class="footer-sigs" style="margin-top:100px;">
            <div>Place: Pethgam<br>Date: <span id="con_date"></span></div>
            <div class="sig-line">Signature of Parent/Guardian</div>
        </div>
        <div style="margin-top:50px; border: 1px solid #000; padding: 10px;">
            <p><strong>Head of School Declaration:</strong> I, <strong>Mohmad Ashraf Rather</strong>, hereby declare that the consent has been verified.</p>
        </div>
    </div>
</div>

<div class="page"><h3>PAGE 3: BIRTH CERTIFICATE</h3><img id="viewBirth" class="doc-preview"></div>
<div class="page"><h3>PAGE 4: BLOOD GROUP REPORT</h3><img id="viewBlood" class="doc-preview"></div>
<div class="page"><h3>PAGE 5: AADHAAR (STUDENT)</h3><img id="viewAadhaarC" class="doc-preview"></div>
<div class="page"><h3>PAGE 6: AADHAAR (PARENT)</h3><img id="viewAadhaarP" class="doc-preview"></div>
<div class="page" id="bankPage"><h3>PAGE 7: BANK PASSBOOK</h3><img id="viewBank" class="doc-preview"></div>

<script>
    window.onload = function() {
        const data = JSON.parse(localStorage.getItem('temp_adm'));
        if (!data) { alert("Data missing!"); return; }

        // Map Table Data
        for (let key in data) {
            let el = document.getElementById('res_' + key);
            if (el) el.innerText = data[key];
        }

        // Map APAAR Page
        document.getElementById('con_parent').innerText = data.parentConsentName || data.fname;
        document.getElementById('con_rel').innerText = data.parentRelation || "Father";
        document.getElementById('con_student').innerText = data.sname;
        document.getElementById('con_idType').innerText = "Aadhaar";
        document.getElementById('con_idNum').innerText = data.parentIdNumber || "";
        document.getElementById('con_date').innerText = data.consentDate || new Date().toLocaleDateString();

        // Map Images
        if(data.studentPhoto) document.getElementById('pdfPhoto').src = data.studentPhoto;
        if(data.docBirth) document.getElementById('viewBirth').src = data.docBirth;
        if(data.docBlood) document.getElementById('viewBlood').src = data.docBlood;
        if(data.docAadhaarChild) document.getElementById('viewAadhaarC').src = data.docAadhaarChild;
        if(data.docAadhaarParent) document.getElementById('viewAadhaarP').src = data.docAadhaarParent;
        
        if(data.docBank) {
            document.getElementById('viewBank').src = data.docBank;
        } else {
            document.getElementById('bankPage').style.display = 'none';
        }

        // Trigger Auto-Print
        setTimeout(() => { window.print(); }, 1500);
    };
</script>
</body>
</html>
