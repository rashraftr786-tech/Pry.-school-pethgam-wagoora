<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APAAR Consent Form | GPS Pethgam</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;900&display=swap');
        @page { size: A4; margin: 0; }
        body { background-color: #f1f5f9; font-family: 'Arial', sans-serif; margin: 0; padding: 0; }
        .form-page { 
            width: 210mm; height: 297mm; background: white; margin: 10px auto; 
            padding: 15mm 20mm; border: 1px solid #000; position: relative; box-sizing: border-box;
        }
        .box-grid { display: flex; gap: 0; margin-top: 2px; }
        .char-box { width: 24px; height: 28px; border: 1px solid #000; text-align: center; line-height: 28px; font-size: 14px; font-weight: bold; }
        @media print { .no-print { display: none; } .form-page { margin: 0; border: none; } }
    </style>
</head>
<body class="pb-20">

    <div class="no-print max-w-4xl mx-auto mt-6 bg-white p-4 rounded-2xl shadow-lg border-l-8 border-orange-500 flex justify-between items-center">
        <div>
            <h2 class="font-black text-slate-800 uppercase text-sm">APAAR Consent Generation</h2>
            <p class="text-[10px] text-slate-500">Linked with Admission Form No: <span id="linkDisplay" class="font-bold text-orange-600">---</span></p>
        </div>
        <button onclick="saveApaarPDF()" class="bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 px-6 rounded-lg uppercase text-xs shadow-md transition-all">
            Download APAAR Form
        </button>
    </div>

    <div class="form-page" id="apaarTemplate">
        <div class="absolute top-10 right-10 text-right">
            <div class="border border-black p-1">
                <p class="text-[9px] font-bold uppercase leading-none">Linked Admission Form No:</p>
                <p id="apaar_linked_no" class="text-lg font-black tracking-tighter">250401</p>
            </div>
        </div>

        <div class="flex items-center border-b-2 border-black pb-4 mb-8">
            <div class="flex-1 text-center">
                <h1 class="text-3xl font-black uppercase leading-tight">Government Primary School</h1>
                <p class="text-xl font-bold">Pethgam Wagoora 193109</p>
                <div class="mt-4 inline-block bg-black text-white px-6 py-1 text-xl font-bold tracking-widest uppercase">
                    APAAR CONSENT FORM
                </div>
            </div>
        </div>

        <div class="space-y-8 text-[15px] leading-relaxed text-justify">
            <p>
                I, <strong><span id="out_parent" class="border-b border-black px-4 italic">__________________________</span></strong>, 
                parent/guardian of <strong><span id="out_student" class="border-b-2 border-black px-4 font-black">__________________________</span></strong>, 
                bearing Admission Form No. <strong><span id="out_form_no" class="border-b border-black px-2">_________</span></strong>, 
                studying in Class <strong><span id="out_class" class="border-b border-black px-2">__________</span></strong>, 
                hereby give my voluntary consent for the following:
            </p>

            <div class="ml-4 space-y-4">
                <div class="flex gap-4">
                    <span class="font-bold">1.</span>
                    <p>I agree to the creation of a unique <strong>APAAR ID</strong> (Automated Permanent Academic Account Registry) for my ward through the Academic Bank of Credits (ABC) platform.</p>
                </div>
                <div class="flex gap-4">
                    <span class="font-bold">2.</span>
                    <p>I authorize the school and the Ministry of Education to use my wardâ€™s <strong>Aadhaar Number</strong> for identity verification and to capture educational records, achievements, and scholarships.</p>
                </div>
                <div class="flex gap-4">
                    <span class="font-bold">3.</span>
                    <p>I understand that the Aadhaar details will be used only for demographic authentication and official academic tracking purposes.</p>
                </div>
            </div>

            <div class="mt-8">
                <label class="text-sm font-bold uppercase underline">Student's Aadhaar Number:</label>
                <div class="box-grid" id="apaar_grid"></div>
            </div>

            <p class="mt-8 italic text-sm">
                I understand that this consent is voluntary and can be withdrawn at any time. I am providing this information of my own free will.
            </p>

            <div class="flex justify-between mt-24">
                <div class="text-center">
                    <p class="w-48 border-t border-black pt-1 font-bold">Date: ____/____/2025</p>
                    <p class="text-[10px] mt-1 uppercase text-slate-500">Place: Pethgam</p>
                </div>
                <div class="text-center">
                    <p class="w-64 border-t border-black pt-1 font-bold uppercase">Signature of Parent/Guardian</p>
                    <p class="text-[11px] mt-1 font-bold" id="out_mobile">Mobile: ________________</p>
                </div>
            </div>
        </div>

        <div class="absolute bottom-20 left-20 right-20 text-center">
            <div class="border-2 border-dotted border-slate-400 p-6 opacity-30">
                <p class="text-sm font-bold text-slate-400 uppercase">Headmaster Verification & School Seal</p>
            </div>
        </div>
    </div>

    <script>
        // GRID INITIALIZATION
        function createGrid(id, count) {
            const container = document.getElementById(id);
            for(let i=0; i<count; i++) {
                const box = document.createElement('div');
                box.className = 'char-box';
                container.appendChild(box);
            }
        }

        // SYNC LOGIC (To be called from your main form)
        function syncFromMainForm(data) {
            document.getElementById('out_student').innerText = data.studentName.toUpperCase();
            document.getElementById('out_parent').innerText = data.parentName.toUpperCase();
            document.getElementById('out_class').innerText = data.className;
            document.getElementById('out_form_no').innerText = data.formNo;
            document.getElementById('apaar_linked_no').innerText = data.formNo;
            document.getElementById('linkDisplay').innerText = data.formNo;
            document.getElementById('out_mobile').innerText = "Mobile: " + data.mobile;

            // Fill Aadhaar Grid
            const boxes = document.getElementById('apaar_grid').querySelectorAll('.char-box');
            const chars = data.aadhaar.split('');
            boxes.forEach((box, i) => box.innerText = chars[i] || '');
        }

        function saveApaarPDF() {
            const element = document.getElementById('apaarTemplate');
            const name = document.getElementById('out_student').innerText || "Student";
            html2pdf().set({
                margin: 0,
                filename: `APAAR_Consent_${name}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            }).from(element).save();
        }

        // Initialize Aadhaar Grid (12 digits)
        createGrid('apaar_grid', 12);

        // Example: Listening to the main form (if in same window)
        // You can trigger syncFromMainForm from your main admission panel
    </script>
</body>
</html>
