<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Ledger | GPS Pethgam</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .custom-scrollbar::-webkit-scrollbar { height: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .field-label { font-size: 9px; text-transform: uppercase; color: #94a3b8; font-weight: 800; display: block; margin-bottom: 2px; }
    </style>
</head>
<body class="bg-white font-sans p-4">

    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
        <div>
            <h1 class="text-xl font-black text-slate-800 uppercase italic">Master Student Ledger</h1>
            <p class="text-[10px] text-blue-500 font-bold tracking-widest uppercase">GPS Pethgam Wagoora</p>
        </div>
        <div class="flex gap-2 w-full md:w-auto">
            <input type="text" placeholder="Search by Aadhaar, PEN, or Name..." class="flex-1 bg-slate-100 border-none rounded-xl px-4 py-2 text-xs focus:ring-2 focus:ring-blue-500 outline-none">
            <button class="bg-slate-900 text-white p-2 px-4 rounded-xl text-xs font-bold uppercase hover:bg-blue-600 transition-all">Filter</button>
        </div>
    </div>

    <div class="overflow-x-auto custom-scrollbar border border-slate-100 rounded-3xl shadow-sm">
        <table class="w-full text-left min-w-[1800px]">
            <thead class="bg-slate-50 border-b border-slate-100">
                <tr class="text-[10px] font-black uppercase text-slate-400 tracking-tighter">
                    <th class="p-4">Photo</th>
                    <th class="p-4">1. Identity (Name/Aadhaar)</th>
                    <th class="p-4">2. Family (Father/Mother)</th>
                    <th class="p-4">3. Location (DOB/Residence)</th>
                    <th class="p-4">4. Official (PEN/Apaar/Bank)</th>
                    <th class="p-4">5. Status</th>
                    <th class="p-4 text-center">Actions</th>
                </tr>
            </thead>
            <tbody class="text-[11px] font-bold text-slate-600">
                <tr class="border-b border-slate-50 hover:bg-slate-50/80 transition-all">
                    <td class="p-4">
                        <div class="w-12 h-12 bg-slate-100 rounded-2xl border-2 border-white shadow-sm overflow-hidden">
                            <img src="https://via.placeholder.com/150" alt="Student" class="w-full h-full object-cover">
                        </div>
                    </td>
                    <td class="p-4">
                        <span class="field-label">Full Name / Class</span>
                        <p class="text-slate-900 uppercase font-black text-sm">Zaid Bashir</p>
                        <p class="text-blue-600 mb-1">5th Primary</p>
                        <span class="field-label">Aadhaar / Blood / Category</span>
                        <p class="text-[10px]"># 1234-5678-9012 | <span class="text-red-500">B+</span> | ST</p>
                    </td>
                    <td class="p-4">
                        <span class="field-label">Father's Name</span>
                        <p class="uppercase">Bashir Ahmad Rather</p>
                        <span class="field-label mt-2">Mother's Name</span>
                        <p class="uppercase">Haseena Begum</p>
                    </td>
                    <td class="p-4">
                        <span class="field-label">DOB (Date / Words)</span>
                        <p>22/06/2019</p>
                        <p class="text-[9px] text-slate-400 uppercase">Twenty Second June Two Thousand Nineteen</p>
                        <span class="field-label mt-2">Residence / Tehsil / Dist</span>
                        <p class="uppercase tracking-tighter">Pethgam / Wagoora / Baramulla</p>
                    </td>
                    <td class="p-4">
                        <div class="grid grid-cols-2 gap-x-4">
                            <div>
                                <span class="field-label">Bank / Account</span>
                                <p class="uppercase text-[9px]">J&K Bank</p>
                                <p>0123040100012345</p>
                            </div>
                            <div>
                                <span class="field-label">PEN / APAAR ID</span>
                                <p>PEN: 10023456</p>
                                <p>APAAR: 9988-7766</p>
                            </div>
                        </div>
                        <span class="field-label mt-1">IFSC Code</span>
                        <p class="uppercase text-slate-400 text-[9px]">JAKB0WAGOO</p>
                    </td>
                    <td class="p-4 text-center">
                        <div class="flex flex-col gap-1">
                            <span class="bg-emerald-100 text-emerald-700 px-2 py-1 rounded-lg text-[8px] uppercase font-black">Present</span>
                            <span class="bg-orange-100 text-orange-700 px-2 py-1 rounded-lg text-[8px] uppercase font-black">MDM: Consumed</span>
                        </div>
                    </td>
                    <td class="p-4">
                        <div class="flex flex-col gap-2">
                            <button class="bg-slate-100 p-2 rounded-xl hover:bg-blue-600 hover:text-white transition-all"><i class="fa-solid fa-user-pen"></i> Edit</button>
                            <button class="bg-slate-100 p-2 rounded-xl hover:bg-emerald-600 hover:text-white transition-all"><i class="fa-solid fa-print"></i> Card</button>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

</body>
</html>
                            <td class="p-4 text-center">
                                <img src="${s.photo || '../../assets/default-student.png'}" class="w-10 h-10 rounded-xl object-cover border-2 border-slate-200 shadow-sm mx-auto">
                            </td>
                            <td class="p-4">
                                <span class="data-label">Adm No: ${s.admissionNo}</span>
                                <p class="text-sm font-black text-slate-900 uppercase">${s.name}</p>
                                <p class="text-slate-400 italic">Class: ${s.class} | Parent: ${s.parentName}</p>
                                <p class="text-[9px] text-slate-500">${s.address}</p>
                            </td>
                            <td class="p-4">
                                <div class="space-y-1">
                                    <p><span class="text-slate-400">PEN:</span> ${s.penNo || 'N/A'}</p>
                                    <p><span class="text-slate-400">APAAR:</span> ${s.apaarId || 'N/A'}</p>
                                    <p><span class="text-slate-400">AADHAR:</span> ${s.aadharNo}</p>
                                </div>
                            </td>
                            <td class="p-4">
                                <span class="data-label">Bank Details</span>
                                <p class="text-slate-800">${s.bankAccountNo}</p>
                                <p class="text-[9px] text-slate-400 uppercase">${s.ifscCode}</p>
                            </td>
                            <td class="p-4">
                                <div class="flex gap-2">
                                    <span class="bg-red-100 text-red-700 px-2 py-1 rounded text-[9px]">BLOOD: ${s.bloodGroup}</span>
                                    <span class="bg-slate-100 text-slate-700 px-2 py-1 rounded text-[9px]">CAT: ${s.category}</span>
                                </div>
                            </td>
                            <td class="p-4">
                                <div class="flex gap-2 text-slate-400">
                                    <button onclick="editStudent('${doc.id}')" class="p-2 hover:text-blue-600 bg-slate-100 rounded-lg"><i class="fa-solid fa-user-pen"></i></button>
                                    <a href="modules/apaar-consent.html?id=${doc.id}" class="p-2 hover:text-orange-600 bg-slate-100 rounded-lg"><i class="fa-solid fa-id-card"></i></a>
                                </div>
                            </td>
                        </tr>
                    `;
                    table.innerHTML += row;
                });
                
                document.getElementById('stat-total').innerText = count;
                document.getElementById('stat-mdm').innerText = Math.round(count * 0.9) + " Students";

            } catch (error) {
                console.error("Database Error:", error);
                table.innerHTML = `<tr><td colspan="6" class="p-10 text-center text-red-500 font-bold uppercase">Error Loading Data</td></tr>`;
            }
        }

        // Initialize Fetch
        fetchStudents();
        
        // Tab Switcher
        window.switchTab = function(tabId) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('tab-' + tabId).classList.add('active');
            event.currentTarget.classList.add('active');
        }
    </script>
</body>
</html>

