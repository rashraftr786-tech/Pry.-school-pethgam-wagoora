<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPS Pethgam | Multi-Role ERP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="bg-slate-50 min-h-screen">
    <nav class="bg-emerald-900 text-white p-4 sticky top-0 z-50 shadow-lg flex justify-between items-center">
        <div class="flex items-center gap-2">
            <i class="fas fa-university text-xl text-emerald-400"></i>
            <h1 class="font-black uppercase text-sm tracking-tight">GPS Pethgam ERP</h1>
        </div>
        <button id="logoutBtn" class="bg-red-600 hover:bg-red-700 px-3 py-1.5 rounded font-bold text-[10px] transition-all">LOGOUT</button>
    </nav>

    <main class="p-4 max-w-5xl mx-auto">
        <div class="mb-6">
            <h2 class="text-xl font-black text-slate-800">Command Center</h2>
            <p id="userRoleDisplay" class="text-emerald-700 font-bold text-[10px] uppercase tracking-widest mt-1 italic">Verifying Access...</p>
        </div>

        <h3 class="text-slate-400 font-bold text-[10px] uppercase mb-3 border-b pb-1">Enrollment & Student Records</h3>
<div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-8">
    <a href="admission.html" class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 hover:border-emerald-500 transition-all group text-center">
        <i class="fas fa-user-plus text-emerald-600 text-lg mb-2 group-hover:scale-110"></i>
        <p class="text-[10px] font-black text-slate-700 uppercase">New Admission</p>
    </a>
    <a href="adm-register.html" class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 text-center">
        <i class="fas fa-list-ol text-blue-600 text-lg mb-2"></i>
        <p class="text-[10px] font-black text-slate-700 uppercase">Admission Register</p>
    </a>
    <a href="student-id.html" class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 text-center">
        <i class="fas fa-id-badge text-orange-600 text-lg mb-2"></i>
        <p class="text-[10px] font-black text-slate-700 uppercase">Student ID Card</p>
    </a>
</div>

<h3 class="text-slate-400 font-bold text-[10px] uppercase mb-3 border-b pb-1">Academics & Assessment</h3>
<div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-8">
    <a href="attendance.html" class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 text-center">
        <i class="fas fa-calendar-check text-emerald-500 text-lg mb-2"></i>
        <p class="text-[10px] font-black text-slate-700 uppercase">Attendance</p>
    </a>
    <a href="upload-results.html" class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 text-center">
        <i class="fas fa-cloud-upload-alt text-blue-500 text-lg mb-2"></i>
        <p class="text-[10px] font-black text-slate-700 uppercase">Upload Marks</p>
    </a>
    <a href="master-profile.html" class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 text-center">
        <i class="fas fa-table text-purple-600 text-lg mb-2"></i>
        <p class="text-[10px] font-black text-slate-700 uppercase">Master Marks Sheet</p>
    </a>
    <a href="marks-sheet.html" class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 text-center">
        <i class="fas fa-file-invoice text-orange-500 text-lg mb-2"></i>
        <p class="text-[10px] font-black text-slate-700 uppercase">Indiv. Report Card</p>
    </a>
</div>

<h3 class="text-slate-400 font-bold text-[10px] uppercase mb-3 border-b pb-1">Administration & Staff</h3>
<div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-8">
    <a href="staff-entry.html" class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 text-center">
        <i class="fas fa-user-tie text-indigo-600 text-lg mb-2"></i>
        <p class="text-[10px] font-black text-slate-700 uppercase">Staff Entry</p>
    </a>
    <a href="tc.html" class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 text-center">
        <i class="fas fa-file-export text-red-600 text-lg mb-2"></i>
        <p class="text-[10px] font-black text-slate-700 uppercase">T.C Issue</p>
    </a>
    <a href="bonafide.html" class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 text-center">
        <i class="fas fa-stamp text-teal-600 text-lg mb-2"></i>
        <p class="text-[10px] font-black text-slate-700 uppercase">Bonafide</p>
    </a>
    <a href="mdm.html" class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 text-center">
        <i class="fas fa-utensils text-orange-400 text-lg mb-2"></i>
        <p class="text-[10px] font-black text-slate-700 uppercase">MDM Portal</p>
    </a>
</div>
        <h3 class="text-slate-400 font-bold text-[10px] uppercase mb-3 border-b pb-1">Logistics & Communication</h3>
<div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-8">
    <a href="textbook-issue.html" class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 text-center hover:border-emerald-500 transition-all">
        <i class="fas fa-book text-emerald-600 text-lg mb-2"></i>
        <p class="text-[10px] font-black text-slate-700 uppercase">Textbook Issue</p>
    </a>
    <a href="library.html" class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 text-center hover:border-blue-500 transition-all">
        <i class="fas fa-library text-blue-600 text-lg mb-2"></i>
        <p class="text-[10px] font-black text-slate-700 uppercase">Library Manager</p>
    </a>
    <a href="timetable.html" class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 text-center hover:border-purple-500 transition-all">
        <i class="fas fa-clock text-purple-600 text-lg mb-2"></i>
        <p class="text-[10px] font-black text-slate-700 uppercase">Timetable</p>
    </a>
    <a href="comm-logs.html" class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 text-center hover:border-orange-500 transition-all">
        <i class="fas fa-comment-dots text-orange-500 text-lg mb-2"></i>
        <p class="text-[10px] font-black text-slate-700 uppercase">Comm. Logs</p>
    </a>
</div>
        <h3 class="text-slate-400 font-bold text-[10px] uppercase mb-3 border-b pb-1 text-left">Communication Center</h3>
<div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-8">
    
    <a href="broadcast-whatsapp.html" class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 text-center hover:border-emerald-500 hover:shadow-md transition-all group">
        <i class="fab fa-whatsapp text-emerald-500 text-xl mb-2 group-hover:scale-110 transition-transform"></i>
        <p class="text-[10px] font-black text-slate-700 uppercase">WhatsApp</p>
    </a>

    <a href="send-sms.html" class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 text-center hover:border-blue-500 hover:shadow-md transition-all group">
        <i class="fas fa-comment-alt text-blue-500 text-xl mb-2 group-hover:scale-110 transition-transform"></i>
        <p class="text-[10px] font-black text-slate-700 uppercase">Direct SMS</p>
    </a>

    <a href="send-email.html" class="bg-white p-4 rounded-2xl shadow-sm border border-slate-100 text-center hover:border-indigo-500 hover:shadow-md transition-all group">
        <i class="fas fa-envelope-open-text text-indigo-500 text-xl mb-2 group-hover:scale-110 transition-transform"></i>
        <p class="text-[10px] font-black text-slate-700 uppercase">Email Dispatch</p>
    </a>

    <a href="comm-logs.html" class="bg-slate-800 p-4 rounded-2xl shadow-sm text-center hover:bg-black transition-all group">
        <i class="fas fa-history text-slate-300 text-xl mb-2 group-hover:rotate-[-10deg] transition-transform"></i>
        <p class="text-[10px] font-black text-white uppercase">Comm. Logs</p>
    </a>

</div>
        
        

    </main>

    <script type="module">
        import { auth, db } from './init-firebase.js';
        import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const roleDisplay = document.getElementById('userRoleDisplay');

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                // Fetch the role from your Firestore staffRecords
                try {
                    const q = query(collection(db, "staffRecords"), where("email", "==", user.email));
                    const snap = await getDocs(q);
                    const userData = snap.docs[0].data();
                    roleDisplay.innerText = `${userData.role} Portal: ${user.email}`;
                } catch (e) {
                    roleDisplay.innerText = "Authorized: " + user.email;
                }
            } else {
                window.location.replace("signin.html");
            }
        });

        document.getElementById('logoutBtn').addEventListener('click', async () => {
            await signOut(auth);
            window.location.replace("signin.html");
        });
    </script>
</body>
</html>
